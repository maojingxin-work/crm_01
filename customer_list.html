<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>客户列表</title>
    <!--<meta name="viewport" content="width=device-width,user-scalable = no, initial-scale = 1.0, maximum-scale=1.0">-->

    <!--&lt;!&ndash;iphone设备中的safari私有meta标签，它表示：允许全屏模式浏览&ndash;&gt;-->
    <!--<meta content="yes" name="apple-mobile-web-app-capable">-->
    <!--&lt;!&ndash;iphone的私有标签，它指定的iphone中safari顶端的状态条的样式&ndash;&gt;-->
    <!--<meta content="black" name="apple-mobile-web-app-status-bar-style">-->
    <!--&lt;!&ndash;告诉设备忽略将页面中的数字识别为电话号码&ndash;&gt;-->
    <!--<meta content="telephone=no" name="format-detection">-->
    <!--&lt;!&ndash;去除Android平台邮箱识别&ndash;&gt;-->
    <!--<meta content="email=no" name="format-detection"/>-->

    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <link rel="icon" href="img/logo_img.png">

    <link rel="stylesheet" type="text/css" href="css/mui.css"/>
    <link rel="stylesheet" type="text/css" href="css/mui.picker.min.css"/>
    <link rel="stylesheet" type="text/css" href="css/mui.poppicker.css"/>

    <link rel="stylesheet" type="text/css" href="css/icons-extra.css"/>
    <link rel="stylesheet" type="text/css" href="css/crm_leads.css"/>
    <link rel="stylesheet" type="text/css" href="css/customer.css"/>

    <link rel="stylesheet" type="text/css" href="css/mescroll.min.css"/>

    <style>
        .connection button {
            display: inline-block;
            width: 40%;
            margin-top: 10px;
            padding: 5px;
        }
        .mui-input-group {
            text-align: center;
            background-color: #f5f5f5;
            padding-bottom: 20px;
            border-bottom: 1px solid #6d6d72;
        }
        .mui-input-group button {
            display: inline-block;
            width: 80%;
            margin-top: 10px;
            padding: 5px;

        }
        .mui-button-row .mui-btn {
            display:  inline-block;
            width: 40%;
        }


        #addpage {
            width: 4em;
            height: 4em;
            border-radius: 50%;
            text-align: center;
            position: fixed;
            bottom: 4.5em;
            right: 1em;
        }
        #addpage.mui-right:before {
            /* float: right; */
            /* padding-left: 0; */
            font-size: 4em;
            display: inline-block;
            position: absolute;
            top: -12px;
            right: -1px;
        }
    </style>

</head>
<body>
<div class="search">
    <div class="filter">
        时间查询 <i class="mui-icon mui-icon-arrowdown"></i>
    </div>
    <div class="c-time">
        筛选 <i class="mui-icon mui-icon-arrowdown"></i>
    </div>
</div>
<div class="connection hide">
    <button id="demo1" data-options="{&quot;type&quot;:&quot;date&quot;,&quot;beginYear&quot;:2014,&quot;endYear&quot;:2016}" class="btn mui-btn mui-btn-block">开始日期 ...</button>
    &emsp;
    <button id="demo2" data-options="{&quot;type&quot;:&quot;date&quot;,&quot;beginYear&quot;:2014,&quot;endYear&quot;:2016}" class="btn mui-btn mui-btn-block">结束日期 ...</button>
</div>

<div class="search-info hide" style="">
    <form class="mui-input-group" style="width:100%;">
        <div class="mui-input-row">
            <label>姓名</label>
            <input type="text" placeholder="">
        </div>
        <button id="showUserPicker" class="mui-btn mui-btn-block" type="button">一级选择示例 ...</button>

        <div class="mui-input-row mui-plus-visible">
            <label>Input</label>
            <input type="text" class="mui-input-speech mui-input-clear" placeholder="语音输入" data-input-clear="6" data-input-speech="6"><span class="mui-icon mui-icon-clear mui-hidden"></span><span class="mui-icon mui-icon-speech"></span>
        </div>
        <div class="mui-button-row">
            <button type="button" class="mui-btn mui-btn-primary" onclick="return false;">确认</button>&nbsp;&nbsp;
            <button type="button" class="mui-btn mui-btn-danger" onclick="return false;">取消</button>
        </div>
    </form>

</div>

<div class="mui-content">

    <div id="mescroll" class="content mescroll">
        <ul id="scroller" class="mui-table-view">
            <li class="mui-table-view-cell mui-transitioning">
                <div class="mui-slider-right mui-disabled">
                    <a class="mui-btn mui-btn-grey mui-icon mui-icon-person" style="transform: translate(0px, 0px);"></a>
                    <a class="mui-btn mui-btn-yellow mui-icon mui-icon-phone" style="transform: translate(-90px, 0px);"></a>
                </div>
                <div class="mui-slider-handle" style="transform: translate(0px, 0px);">
                    <div class="mui-table-cell">
                        <div class="table-customer">
                            张三  <span class="table-type">抵押</span><span class="mui-icon mui-icon-star-filled"><i>A</i></span>
                        </div>
                        <div class="table-employee">
                            负责人：齐洁洁 <span class="table-time">创建时间：2018-04-16 10:12:51</span>
                        </div>
                    </div>
                </div>
            </li>
            <li class="mui-table-view-cell mui-transitioning">
                <div class="mui-slider-right mui-disabled">
                    <a class="mui-btn mui-btn-grey mui-icon mui-icon-person" style="transform: translate(0px, 0px);"></a>
                    <a class="mui-btn mui-btn-yellow mui-icon mui-icon-phone" style="transform: translate(-90px, 0px);"></a>
                </div>
                <div class="mui-slider-handle" style="transform: translate(0px, 0px);">
                    <div class="mui-table-cell">
                        <div class="table-customer">
                            张三  <span class="table-type">抵押</span><span class="mui-icon mui-icon-star-filled"><i>A</i></span>
                        </div>
                        <div class="table-employee">
                            负责人：齐洁洁 <span class="table-time">创建时间：2018-04-16 10:12:51</span>
                        </div>
                    </div>
                </div>
            </li>
            <li class="mui-table-view-cell mui-transitioning">
                <div class="mui-slider-right mui-disabled">
                    <a class="mui-btn mui-btn-grey mui-icon mui-icon-person" style="transform: translate(0px, 0px);"></a>
                    <a class="mui-btn mui-btn-yellow mui-icon mui-icon-phone" style="transform: translate(-90px, 0px);"></a>
                </div>
                <div class="mui-slider-handle" style="transform: translate(0px, 0px);">
                    <div class="mui-table-cell">
                        <div class="table-customer">
                            张三  <span class="table-type">抵押</span><span class="mui-icon mui-icon-star-filled"><i>A</i></span>
                        </div>
                        <div class="table-employee">
                            负责人：齐洁洁 <span class="table-time">创建时间：2018-04-16 10:12:51</span>
                        </div>
                    </div>
                </div>
            </li>
        </ul>
    </div>
</div>
<button id="addpage" type="button" class="mui-btn mui-btn-success mui-icon mui-icon-plus mui-right"></button>

<nav class="mui-bar mui-bar-tab">
    <a class="mui-tab-item" href="index.html">
        <span class="mui-icon mui-icon-home"></span>
        <span class="mui-tab-label">首页</span>
    </a>
    <a class="mui-tab-item mui-active" href=" ">
        <span class="mui-icon mui-icon-settings"></span>
        <span class="mui-tab-label">列表</span>
    </a>
</nav>

<!--MUI框架-->
<script src="js/mui.js"></script>
<!--日期选择插件-->
<script src="js/mui.picker.min.js"></script>
<!--联动选择插件-->
<script src="js/mui.poppicker.js"></script>

<!--JQuery插件-->
<script src="js/jquery-3.3.1.js"></script>
<!--上拉加载 下拉刷新-->
<script src="js/mescroll.min.js"></script>

<!--MUI初始化 和mescroll-->
<script>
    mui.init();

    var mescroll = new MeScroll("mescroll", { //第一个参数"mescroll"对应上面布局结构div的id
        //如果您的下拉刷新是重置列表数据,那么down完全可以不用配置,具体用法参考第一个基础案例
        //解析: down.callback默认调用mescroll.resetUpScroll(),而resetUpScroll会将page.num=1,再触发up.callback
        down: {
            callback: downCallback, //下拉刷新的回调,别写成downCallback(),多了括号就自动执行方法了
        },
        up: {
            auto:false,
            callback: upCallback , //上拉加载的回调
            isBounce: false, //如果您的项目是在iOS的微信,QQ,Safari等浏览器访问的,建议配置此项.解析(必读)
            noMoreSize:10
        }
    });


    //下拉刷新的回调
    function downCallback() {
        console.log('refresh');
        $('#scroller').html('');
        mescroll.resetUpScroll();
    }

    //上拉加载的回调 page = {num:1, size:10}; num:当前页 默认从1开始, size:每页数据条数,默认10
    function upCallback(page) {

        var p = page['num'];
        $.ajax({
            type: 'POST',
            url: 'a.json',
            data:{'p':p},
            dataType: 'json',
            success: function(res){

                var arrlen = res.data.length;
                if(arrlen >0){

                    var result = '';
                    var data = res.data;
                    for(var i = 0; i < arrlen; i++){
                        result +='<li class="mui-table-view-cell mui-transitioning">\n' +
                            '                <div class="mui-slider-right mui-disabled">\n' +
                            '                    <a class="mui-btn mui-btn-grey mui-icon mui-icon-person" style="transform: translate(0px, 0px);"></a>\n' +
                            '                    <a class="mui-btn mui-btn-yellow mui-icon mui-icon-phone" style="transform: translate(-90px, 0px);"></a>\n' +
                            '                </div>\n' +
                            '                <div class="mui-slider-handle" style="transform: translate(0px, 0px);">\n' +
                            '                    <div class="mui-table-cell">\n' +
                            '                        <div class="table-customer">\n' +
                            '                            张三 '+data[i].name+' <span class="table-type">抵押</span><span class="mui-icon mui-icon-star-filled"><i>A</i></span>\n' +
                            '                        </div>\n' +
                            '                        <div class="table-employee">\n' +
                            '                            负责人：齐洁洁 <span class="table-time">创建时间：2018-04-16 10:12:51</span>\n' +
                            '                        </div>\n' +
                            '                    </div>\n' +
                            '                </div>\n' +
                            '            </li>';
                    }
                    $('#scroller').append(result);
                    mescroll.endSuccess(arrlen);
                }
                else{
                    mescroll.endErr();
                }
                // 插入数据到页面，放到最后面

            },
            error: function(xhr, type){
                mescroll.endErr();
            }
        });

    }
</script>

<!--自定义内容-->
<script>
    $('[data-condition]').click(function () {
        var lis = $('[data-condition]');
        lis.each(function () {
            $(this).removeClass('active')
        });

        $(this).addClass('active');
        var condition = $(this).data('condition');
        var formtype = $(this).data('formtype');
        var field = $(this).data('field');
        var htmlSetting = $(this).data('htmlSetting');
        console.log(htmlSetting);
        var html ='<input type="text" placeholder="输入信息">';
        if(formtype == 'box'){
            html = '<select>';
            for ( i in htmlSetting){
                html+='<option value="'+htmlSetting[i]+'">'+htmlSetting[i]+'</option>';
            }
            html+='</select>';

        }

        // if(condition == 1){
        //     html += '<select>\n' +
        //         '                <option>来源来源</option>\n' +
        //         '                <option>来源来源</option>\n' +
        //         '                <option>来源来源</option>\n' +
        //         '                <option>来源来源</option>\n' +
        //         '            </select>\n';
        // }else {
        //     html += '<input type="text" placeholder="输入信息">\n';
        // }




        $('.information').html(html);
    });

    $('.c-time').click(function () {
        $('.search-info').removeClass('hide');
    });

    $('.no-btn').click(function () {
        $('.search-info').addClass('hide');

    });

    $('.yes-btn').click(function () {
        var field = $('.active').data('field');
        var valNode = $('.information').children()[0];
        var val = $(valNode).val();

        var searchObj = {};
        searchObj.searchfield = JSON.stringify({'field':field,'val':val});
        searchObj.by = $('.select-time').data('dateBy');
        console.log(searchObj);

        mescroll.triggerDownScroll();

        $('.search-info').addClass('hide');
    });

    $('.filter').click(function () {
        $('.connection').removeClass('hide');
    });

    $('[data-date-by]').click(function () {

        $('[data-date-by]').each(function () {
            $(this).removeClass('select-time');
        });

        $(this).addClass('select-time');

        var str = $(this).html();
        var cNode = $('.c-time');
        cNode.html(str);
        cNode.css('color','#110ff2');

        $('.connection').addClass('hide');

        mescroll.triggerDownScroll();

    })
</script>

<!--日期选择-->
<script>
    (function($) {
        $.init();
        var result = $('#result')[0];
        var btns = $('.btn');
        btns.each(function(i, btn) {
            btn.addEventListener('tap', function() {
                var _self = this;
                if(_self.picker) {
                    _self.picker.show(function (rs) {
                        result.innerText = '选择结果: ' + rs.text;
                        _self.picker.dispose();
                        _self.picker = null;
                    });
                } else {
                    var optionsJson = this.getAttribute('data-options') || '{}';
                    var options = JSON.parse(optionsJson);
                    var id = this.getAttribute('id');
                    /*
                     * 首次显示时实例化组件
                     * 示例为了简洁，将 options 放在了按钮的 dom 上
                     * 也可以直接通过代码声明 optinos 用于实例化 DtPicker
                     */
                    _self.picker = new $.DtPicker(options);
                    _self.picker.show(function(rs) {
                        /*
                         * rs.value 拼合后的 value
                         * rs.text 拼合后的 text
                         * rs.y 年，可以通过 rs.y.vaue 和 rs.y.text 获取值和文本
                         * rs.m 月，用法同年
                         * rs.d 日，用法同年
                         * rs.h 时，用法同年
                         * rs.i 分（minutes 的第二个字母），用法同年
                         */
                        result.innerText = '选择结果: ' + rs.text;
                        /*
                         * 返回 false 可以阻止选择框的关闭
                         * return false;
                         */
                        /*
                         * 释放组件资源，释放后将将不能再操作组件
                         * 通常情况下，不需要示放组件，new DtPicker(options) 后，可以一直使用。
                         * 当前示例，因为内容较多，如不进行资原释放，在某些设备上会较慢。
                         * 所以每次用完便立即调用 dispose 进行释放，下次用时再创建新实例。
                         */
                        _self.picker.dispose();
                        _self.picker = null;
                    });
                }

            }, false);
        });
    })(mui);
</script>

<!--联动选择-->
<script>
    (function($, doc) {
        $.init();
        $.ready(function() {
            /**
             * 获取对象属性的值
             * 主要用于过滤三级联动中，可能出现的最低级的数据不存在的情况，实际开发中需要注意这一点；
             * @param {Object} obj 对象
             * @param {String} param 属性名
             */
            var _getParam = function(obj, param) {
                return obj[param] || '';
            };
            //普通示例
            var userPicker = new $.PopPicker();
            userPicker.setData([{
                value: 'ywj',
                text: '董事长 叶文洁'
            }, {
                value: 'aaa',
                text: '总经理 艾AA'
            }, {
                value: 'lj',
                text: '罗辑'
            }, {
                value: 'ymt',
                text: '云天明'
            }, {
                value: 'shq',
                text: '史强'
            }, {
                value: 'zhbh',
                text: '章北海'
            }, {
                value: 'zhy',
                text: '庄颜'
            }, {
                value: 'gyf',
                text: '关一帆'
            }, {
                value: 'zhz',
                text: '智子'
            }, {
                value: 'gezh',
                text: '歌者'
            }]);
            var showUserPickerButton = doc.getElementById('showUserPicker');
            var userResult = doc.getElementById('userResult');
            showUserPickerButton.addEventListener('tap', function(event) {
                userPicker.show(function(items) {
                    userResult.innerText = JSON.stringify(items[0]);
                    //返回 false 可以阻止选择框的关闭
                    //return false;
                });
            }, false);
            //-----------------------------------------
            //级联示例
            var cityPicker = new $.PopPicker({
                layer: 2
            });
            cityPicker.setData(cityData);
            var showCityPickerButton = doc.getElementById('showCityPicker');
            var cityResult = doc.getElementById('cityResult');
            showCityPickerButton.addEventListener('tap', function(event) {
                cityPicker.show(function(items) {
                    cityResult.innerText = "你选择的城市是:" + items[0].text + " " + items[1].text;
                    //返回 false 可以阻止选择框的关闭
                    //return false;
                });
            }, false);
            //-----------------------------------------
            //					//级联示例
            var cityPicker3 = new $.PopPicker({
                layer: 3
            });
            cityPicker3.setData(cityData3);
            var showCityPickerButton = doc.getElementById('showCityPicker3');
            var cityResult3 = doc.getElementById('cityResult3');
            showCityPickerButton.addEventListener('tap', function(event) {
                cityPicker3.show(function(items) {
                    cityResult3.innerText = "你选择的城市是:" + _getParam(items[0], 'text') + " " + _getParam(items[1], 'text') + " " + _getParam(items[2], 'text');
                    //返回 false 可以阻止选择框的关闭
                    //return false;
                });
            }, false);
        });
    })(mui, document);
</script>

</body>
</html>